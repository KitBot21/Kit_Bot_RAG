# RAG Generation 품질 평가 루브릭

## 평가 개요

**목적**: LLM이 생성한 답변의 품질을 정량적으로 측정  
**방법**: 4가지 기준으로 각 1-5점 척도 평가  
**대상**: 10개 샘플 답변 (Ground Truth와 무관하게 평가)

---

## 📊 평가 기준 (4가지)

### 1. 정확성 (Accuracy) - 사실 정확도

**질문**: 답변이 **사실적으로 정확한가**?

| 점수 | 등급 | 설명 | 예시 |
|------|------|------|------|
| **5점** | 완전 정확 | 모든 정보가 정확하고 검증 가능 | "생활관 식사는 평일 11:30-13:30, 17:00-19:00" (정확한 시간) |
| **4점** | 대체로 정확 | 핵심 정보는 정확하나 일부 사소한 오류 | "생활관 식사는 12시-2시, 5시-7시" (정확하지만 덜 구체적) |
| **3점** | 부분 정확 | 일부 정보는 정확하지만 중요한 오류 포함 | "평일과 주말 시간이 동일" (실제로는 다름) |
| **2점** | 부정확 | 대부분의 정보가 틀리거나 오래됨 | "2020년 기준 식사 시간" (현재와 다름) |
| **1점** | 완전 오류 | 모든 정보가 틀리거나 환각(hallucination) | "생활관에는 식당이 없습니다" (사실과 반대) |

**평가 팁**:
- 실제 학교 정보와 대조 (가능한 경우)
- 날짜, 시간, 장소 등 구체적 정보의 정확성 확인
- 최신성 확인 (오래된 정보는 감점)

---

### 2. 관련성 (Relevance) - 질문-답변 일치도

**질문**: 답변이 **질문과 관련있는가**?

| 점수 | 등급 | 설명 | 예시 |
|------|------|------|------|
| **5점** | 완전 관련 | 질문에 정확히 답변, 불필요한 정보 없음 | Q: "식사 시간?" → A: "11:30-13:30" (직접 답변) |
| **4점** | 대체로 관련 | 핵심 답변 포함, 약간의 추가 정보 | Q: "식사 시간?" → A: "11:30-13:30 + 메뉴 정보" (관련 정보) |
| **3점** | 부분 관련 | 답변은 하지만 불필요한 정보가 많음 | Q: "식사 시간?" → A: "식사 시간, 위치, 가격, 역사..." (과도) |
| **2점** | 약간 관련 | 질문과 간접적으로만 관련 | Q: "식사 시간?" → A: "생활관에는 식당이 있습니다" (답변 회피) |
| **1점** | 무관 | 질문과 전혀 관련없는 답변 | Q: "식사 시간?" → A: "도서관 운영 시간은..." (완전 다른 주제) |

**평가 팁**:
- 질문의 핵심 의도 파악
- "Yes/No" 질문에는 명확한 답변이 있는지 확인
- "무엇", "언제", "어디서" 질문에 대한 직접 답변 확인

---

### 3. 완성도 (Completeness) - 정보의 충분성

**질문**: 답변이 **충분히 상세하고 완전한가**?

| 점수 | 등급 | 설명 | 예시 |
|------|------|------|------|
| **5점** | 완전 충분 | 모든 필요 정보 포함, 추가 질문 불필요 | Q: "전공 변경 방법?" → A: "기간, 장소, 서류, 조건, 절차" (완전) |
| **4점** | 대체로 충분 | 핵심 정보 포함, 일부 세부사항 누락 | Q: "전공 변경 방법?" → A: "기간, 장소, 서류" (절차 누락) |
| **3점** | 보통 | 기본 정보만 제공, 추가 질문 필요 | Q: "전공 변경 방법?" → A: "행정실에 신청하세요" (세부사항 부족) |
| **2점** | 불충분 | 매우 간략, 실질적 도움 부족 | Q: "전공 변경 방법?" → A: "가능합니다" (방법 설명 없음) |
| **1점** | 매우 불충분 | 거의 정보 없음 또는 "모르겠습니다" | Q: "전공 변경 방법?" → A: "잘 모르겠습니다" (도움 안됨) |

**평가 팁**:
- 질문자가 추가 질문 없이 행동할 수 있는지 확인
- Who, What, When, Where, How가 적절히 포함되었는지
- 너무 짧으면 감점, 너무 길면 관련성에서 감점

---

### 4. 근거성 (Groundedness) - 문서 기반 답변

**질문**: 답변이 **제공된 문서에 근거하는가**?

| 점수 | 등급 | 설명 | 예시 |
|------|------|------|------|
| **5점** | 완전 근거 | 모든 정보가 문서에서 추출됨, 추론 없음 | 문서: "식사 11:30" → 답변: "11:30" (직접 인용) |
| **4점** | 대체로 근거 | 대부분 문서 기반, 일부 논리적 추론 | 문서: "평일 11:30" → 답변: "점심은 11:30" (합리적 해석) |
| **3점** | 부분 근거 | 문서 기반 + 일반 지식 혼합 | 문서: "식사 제공" → 답변: "보통 12시쯤" (추측 포함) |
| **2점** | 약한 근거 | 대부분 일반 지식, 문서는 부분적 | 문서: "생활관" → 답변: "대부분 대학 기숙사는..." (일반론) |
| **1점** | 근거 없음 | 문서와 무관한 정보 또는 환각 | 문서: 없음 → 답변: "확실히 9시에..." (완전 추측) |

**평가 팁**:
- 답변의 각 문장이 문서에 있는지 확인
- "일반적으로", "보통" 같은 표현은 근거 약함
- 인용 또는 출처 명시는 높은 점수

---

## 🎯 종합 점수 계산

### Overall Score (전체 점수)

```
Overall = (정확성 + 관련성 + 완성도 + 근거성) / 4
```

**예시**:
- 정확성: 4점
- 관련성: 5점
- 완성도: 3점
- 근거성: 4점
- **Overall: 4.0/5.0**

### 등급 기준

| Overall 점수 | 등급 | 평가 | 조치 |
|-------------|------|------|------|
| **4.5 - 5.0** | A (우수) | 배포 가능 | 유지 |
| **4.0 - 4.4** | B (양호) | 일부 개선 필요 | 프롬프트 조정 |
| **3.5 - 3.9** | C (보통) | 개선 필요 | Retrieval + Prompt 개선 |
| **3.0 - 3.4** | D (미흡) | 상당한 개선 필요 | 시스템 재설계 |
| **1.0 - 2.9** | F (부적합) | 배포 불가 | 전면 재검토 |

---

## 📝 평가 예시

### 예시 1: 우수한 답변 (Overall 4.5/5.0)

**질문**: "생활관 식사 시간이 궁금해요"

**답변**:
```
생활관 식사 시간은 다음과 같습니다:

1. 푸름관 및 오름관 1동
   - 평일: 중식 11:30-13:30, 석식 17:00-19:00
   - 주말: 중식 12:00-13:00, 석식 17:00-18:00

2. 오름관 3동
   - 평일: 중식 11:30-13:30, 석식 17:00-19:00
   - 주말: 중식 12:00-13:30, 석식 17:00-18:30

식사 시간은 수급 사정에 따라 변경될 수 있습니다.
```

**평가**:
- ✅ **정확성: 5점** - 모든 시간이 정확
- ✅ **관련성: 5점** - 질문에 직접 답변
- ✅ **완성도: 4점** - 건물별 구분, 평일/주말 구분 (방학 정보는 생략)
- ✅ **근거성: 5점** - 모든 정보가 문서 기반
- **Overall: 4.75/5.0 → A등급**

---

### 예시 2: 보통 답변 (Overall 3.5/5.0)

**질문**: "통학버스는 몇 시에 출발하나요?"

**답변**:
```
통학버스는 보통 아침 9시-10시 사이에 출발합니다.
정확한 시간은 노선마다 다르니 학교 홈페이지를 확인하세요.
```

**평가**:
- ⚠️ **정확성: 3점** - "보통"은 부정확, 구체적 시간 없음
- ✅ **관련성: 4점** - 질문에 답변했으나 모호함
- ❌ **완성도: 2점** - 매우 간략, 노선 정보 없음
- ⚠️ **근거성: 3점** - 일반적 추측, 문서 직접 인용 없음
- **Overall: 3.0/5.0 → D등급**

---

### 예시 3: 부적합 답변 (Overall 2.0/5.0)

**질문**: "WiFi 비밀번호 알려주세요"

**답변**:
```
금오공과대학교 WiFi는 eduroam을 사용합니다.
비밀번호는 본인의 학번과 생년월일 조합입니다.
```

**평가**:
- ❌ **정확성: 2점** - 비밀번호 정보가 틀림 (환각)
- ✅ **관련성: 4점** - WiFi 관련 답변은 맞음
- ❌ **완성도: 2점** - 구체적 접속 방법 부족
- ❌ **근거성: 1점** - 문서에 없는 정보 (환각)
- **Overall: 2.25/5.0 → F등급**

---

## 🔍 평가 시 주의사항

### 1. 객관성 유지
- ❌ "내가 좋아하는 답변" → 주관적
- ✅ "문서에 근거한 정확한 답변" → 객관적

### 2. 일관성 유지
- 같은 유형의 답변은 같은 기준으로 평가
- 처음 평가한 답변의 점수를 기준으로 삼기

### 3. 균형 잡힌 평가
- 너무 후하게 주지 않기 (거의 모든 답변이 4-5점이면 문제)
- 너무 박하게 주지 않기 (거의 모든 답변이 1-2점이면 문제)
- **이상적 분포**: 평균 3.5-4.0점

### 4. 컨텍스트 고려
- 간단한 질문 ("몇 시?") → 짧은 답변도 완성도 높음
- 복잡한 질문 ("어떻게 하나요?") → 상세한 답변 필요

---

## 📊 평가 결과 해석

### 10개 샘플 평가 후

#### 기준별 평균 계산
```
정확성 평균 = (샘플1 정확성 + ... + 샘플10 정확성) / 10
관련성 평균 = (샘플1 관련성 + ... + 샘플10 관련성) / 10
완성도 평균 = (샘플1 완성도 + ... + 샘플10 완성도) / 10
근거성 평균 = (샘플1 근거성 + ... + 샘플10 근거성) / 10
```

#### 전체 평균
```
Overall = (정확성 평균 + 관련성 평균 + 완성도 평균 + 근거성 평균) / 4
```

#### 결과 예시
```
📊 RAG 시스템 최종 평가 결과

🔍 Retrieval 성능
- Top-1 정확도: 68.6%
- Top-5 정확도: 72.5%
- MRR: 0.706

💬 Generation 품질 (5점 만점)
- 정확성: 4.2/5.0 ✅ (양호)
- 관련성: 4.5/5.0 ✅ (우수)
- 완성도: 3.8/5.0 ⚠️ (보통)
- 근거성: 4.6/5.0 ✅ (우수)
- Overall: 4.3/5.0 → B등급 (양호)
```

---

## 🎯 개선 방향 도출

### 기준별 점수에 따른 개선 방향

| 낮은 점수 기준 | 원인 | 개선 방법 |
|--------------|------|----------|
| **정확성 낮음** | 오래된 데이터, 환각 | Corpus 업데이트, 온도 낮추기 |
| **관련성 낮음** | 검색 실패, 장황함 | Retrieval 개선, 프롬프트 수정 |
| **완성도 낮음** | 너무 간략 | max_tokens 증가, 프롬프트 개선 |
| **근거성 낮음** | 환각, 일반 지식 사용 | 온도 낮추기, 프롬프트 강화 |

### 점수별 우선순위

1. **근거성 < 3.5**: 🚨 **최우선** - 환각 방지 (배포 리스크)
2. **정확성 < 3.5**: ⚠️ **높음** - 틀린 정보 제공 (신뢰도 하락)
3. **관련성 < 3.5**: ⚠️ **높음** - 질문 회피 (사용성 저하)
4. **완성도 < 3.5**: 📝 **중간** - 추가 질문 필요 (편의성 저하)

---

**작성자**: GitHub Copilot  
**문서 버전**: 1.0  
**최종 수정**: 2025-11-04
